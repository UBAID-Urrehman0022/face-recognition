{% extends "layout.html" %}
{%block body %}
    <div class="section">
        <div class="container">
       
            <div class="layout-grid grid">
                <div id="node-f" class="div-block-2">
                    <h1 class="heading-2">Upload your image</h1><img src=""
                        loading="lazy" width="166" alt="" />
                        <!-- form -->
                        {% with messages = get_flashed_messages() %}
                            {% if messages %}
                                <ul>
                                    {% for message in messages %}
                                        <li>{{ message }}</li>
                                    {% endfor %}
                                </ul>
                            {% endif %}
                        {% endwith %}
                        <form action="{{ url_for('upload_picture') }}" id="upload-form" method="POST" enctype="multipart/form-data" class="form">
                            <div class="form-group">
                                <input type="file" name="file" id="file" class="input-file" required>
                                <label for="file" class="button-1 button">Choose a File</label>
                                <!-- <button type="submit" id="submit-btn">Upload</button> -->
                            </div>
                            <div class="form-group">
                                <button type="button" class="button-1 button">Open Camera to Take Image</button>
                            </div>
                            <div class="form-group">
                                <input type="submit" value="Upload" class="button-1 button submit-button"> 
                                                           
                                <button type="reset" class="button-1 button reset-button">Reset</button>
                                <div id="image-preview"></div>
                                
                            </div>
                        </form>
                        {% if filename %}
                            <div>
                                <img src="{{ url_for('uploaded_file', filename=filename) }}" >
                                <!-- width="500" height="500" -->
                              
                            </div>
                        {% endif %}
                        
                    </div>

                <div id="node_7f" class="div-block-3">
                    <h2 class="heading-3">Matched Image</h2>
                        <img src="{{ url_for('uploaded_file', filename=filename) }}" alt="Uploaded Image" width="300" height="300">
                </div>
                <div id="node_3f" class="div-block">
                    <h1 class="heading">Information</h1>
                    <div class="info-pieces">Area:</div>
                    <div class="info-pieces">City :</div>
                    <div class="info-pieces">Nearest Police Station :</div>
                    <a href="#" class="link">Click Here To Share</a>
                </div>
            </div>
        </div>
    </div>  
       <!-- <script src="{{url_for('static' , filename='index.js')}} type="text/javascript""></script> -->
       
       <!-- <form action="." id="upload-form" method="get" enctype="multipart/form-data" class="form">
            <input type="file" name="file" id="file" class="input-file" required>
            <label for="file" class="button-1 button">Choose a File</label>
            <button type="submit" id="submit-btn">Upload</button> 
            
        </form> -->
        <!-- <div id="image-preview"></div>
    <script>
        const form = document.getElementById('upload-form');
        const fileInput = document.getElementById('file');
        const submitBtn = document.getElementById('submit-btn');
        const previewDiv = document.getElementById('image-preview');
  
        form.addEventListener('submit', (event) => {
          event.preventDefault();
          const file = fileInput.files[0];
          if (!file) {
            alert('Please select a file');
            return;
          }
          if (!file.type.startsWith('image/')) {
            alert('Please select an image file');
            return;
          }
          const reader = new FileReader();
          reader.onload = (event) => {
            const img = new Image();
            img.onload = () => {
              const canvas = document.createElement('canvas');
              const ctx = canvas.getContext('2d');
              const maxDimension = 500;
              if (img.width > maxDimension || img.height > maxDimension) {
                const scaleFactor = Math.min(maxDimension / img.width, maxDimension / img.height);
                canvas.width = img.width * scaleFactor;
                canvas.height = img.height * scaleFactor;
              } else {
                canvas.width = img.width;
                canvas.height = img.height;
              }
              ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
              const dataURL = canvas.toDataURL('image/jpeg', 0.8);
              const imgElem = document.createElement('img');
              imgElem.src = dataURL;
              previewDiv.innerHTML = '';
              previewDiv.appendChild(imgElem);
            };
            img.src = event.target.result;
          };
          reader.readAsDataURL(file);
        });
    </script> -->
{% endblock %}

</body>
</html>